<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/32gl-A.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/16gl-A.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="结合 ctf赛题 学习一下 unicorn 引擎的基础使用。 参考文章 unicorn中文文档">
<meta property="og:type" content="article">
<meta property="og:title" content="unicorn">
<meta property="og:url" content="http://example.com/2022/06/24/unicorn/index.html">
<meta property="og:site_name" content="Anza | 学习记录">
<meta property="og:description" content="结合 ctf赛题 学习一下 unicorn 引擎的基础使用。 参考文章 unicorn中文文档">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://m.360buyimg.com/babel/jfs/t1/177336/3/25517/8754/62b52868E53cee082/a11a2873758db905.png">
<meta property="article:published_time" content="2022-06-24T02:46:31.000Z">
<meta property="article:modified_time" content="2023-02-06T11:17:54.969Z">
<meta property="article:author" content="Anza">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://m.360buyimg.com/babel/jfs/t1/177336/3/25517/8754/62b52868E53cee082/a11a2873758db905.png">

<link rel="canonical" href="http://example.com/2022/06/24/unicorn/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>unicorn | Anza | 学习记录</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<link rel="alternate" href="/atom.xml" title="Anza | 学习记录" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Anza | 学习记录</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/06/24/unicorn/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/Haida.png">
      <meta itemprop="name" content="Anza">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Anza | 学习记录">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          unicorn
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-06-24 10:46:31" itemprop="dateCreated datePublished" datetime="2022-06-24T10:46:31+08:00">2022-06-24</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-02-06 19:17:54" itemprop="dateModified" datetime="2023-02-06T19:17:54+08:00">2023-02-06</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/other/" itemprop="url" rel="index"><span itemprop="name">other</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>结合 ctf赛题 学习一下 unicorn 引擎的基础使用。</p>
<p><a target="_blank" rel="noopener" href="https://bbs.pediy.com/thread-224330.htm#msg_header_h3_1">参考文章</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/kabeor/Unicorn-Engine-Documentation/blob/master/Unicorn-Engine%20Documentation.md">unicorn中文文档</a></p>
<span id="more"></span>

<h2 id="hxp-CTF-2017-Fibonacci"><a href="#hxp-CTF-2017-Fibonacci" class="headerlink" title="hxp CTF 2017 Fibonacci"></a>hxp CTF 2017 Fibonacci</h2><p>运行该二进制程序时，我们发现打印<code>flag</code>的速度越来越慢：</p>
<p><img src="https://m.360buyimg.com/babel/jfs/t1/177336/3/25517/8754/62b52868E53cee082/a11a2873758db905.png" alt="1656039526862.png"></p>
<p>因此必须对该程序进行优化，在合理时间内打印出<code>flag</code></p>
<p>利用<code>ida_pro</code>反编译看一下程序：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">main</span><span class="params">(<span class="type">int</span> a1, <span class="type">char</span> **a2, <span class="type">char</span> **a3)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> *v3; <span class="comment">// rbp</span></span><br><span class="line">  <span class="type">int</span> v4; <span class="comment">// ebx</span></span><br><span class="line">  __int64 v5; <span class="comment">// r8</span></span><br><span class="line">  <span class="type">char</span> v6; <span class="comment">// r9</span></span><br><span class="line">  __int64 v7; <span class="comment">// r8</span></span><br><span class="line">  <span class="type">char</span> v8; <span class="comment">// cl</span></span><br><span class="line">  <span class="type">int</span> v10[<span class="number">7</span>]; <span class="comment">// [rsp+Ch] [rbp-1Ch] BYREF</span></span><br><span class="line"></span><br><span class="line">  v3 = &amp;unk_4007E1;</span><br><span class="line">  v4 = <span class="number">0</span>;</span><br><span class="line">  setbuf(<span class="built_in">stdout</span>, <span class="number">0LL</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;The flag is: &quot;</span>);</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    LODWORD(v5) = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">    &#123;</span><br><span class="line">      v10[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">      FIB(v4 + v5, v10);	<span class="comment">//调用 FIB 函数</span></span><br><span class="line">      v8 = v7;</span><br><span class="line">      v5 = v7 + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> ( v5 != <span class="number">8</span> );</span><br><span class="line">    v4 += <span class="number">8</span>;</span><br><span class="line">    <span class="keyword">if</span> ( (v10[<span class="number">0</span>] &lt;&lt; v8) == v6 )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    ++v3;</span><br><span class="line">    _IO_putc(v6 ^ (LOBYTE(v10[<span class="number">0</span>]) &lt;&lt; v8), <span class="built_in">stdout</span>);	<span class="comment">//打印 flag 字符</span></span><br><span class="line">  &#125;</span><br><span class="line">  _IO_putc(<span class="string">&#x27;\n&#x27;</span>, <span class="built_in">stdout</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>再来看一下<code>FIB</code>函数：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">FIB</span><span class="params">(<span class="type">int</span> a1, _DWORD *a2)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> v3; <span class="comment">// er12</span></span><br><span class="line">  __int64 result; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v5; <span class="comment">// esi</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v6; <span class="comment">// esi</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> ( a1 )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( a1 == <span class="number">1</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      result = FIB(<span class="number">0LL</span>, a2);	<span class="comment">// 出口</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      v3 = FIB((a1 - <span class="number">2</span>), a2);	<span class="comment">// 递归调用 FIB</span></span><br><span class="line">      result = v3 + FIB((a1 - <span class="number">1</span>), a2);	<span class="comment">// 递归调用 FIB</span></span><br><span class="line">    &#125;</span><br><span class="line">    v5 = ((result - ((result &gt;&gt; <span class="number">1</span>) &amp; <span class="number">0x55555555</span>)) &gt;&gt; <span class="number">2</span>) &amp; <span class="number">0x33333333</span>;</span><br><span class="line">    v6 = v5</span><br><span class="line">       + ((result - ((result &gt;&gt; <span class="number">1</span>) &amp; <span class="number">0x55555555</span>)) &amp; <span class="number">0x33333333</span>)</span><br><span class="line">       + ((v5 + ((result - ((result &gt;&gt; <span class="number">1</span>) &amp; <span class="number">0x55555555</span>)) &amp; <span class="number">0x33333333</span>)) &gt;&gt; <span class="number">4</span>);</span><br><span class="line">    *a2 ^= ((BYTE1(v6) &amp; <span class="number">0xF</span>) + (v6 &amp; <span class="number">0xF</span>) + ((((v6 &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0xF0F0F</span>) + (v6 &amp; <span class="number">0xF0F0F0F</span>)) &gt;&gt; <span class="number">16</span>)) &amp; <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    *a2 ^= <span class="number">1u</span>;</span><br><span class="line">    result = <span class="number">1LL</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>我们看到程序在不断递归调用<code>FIB</code>，而递归函数的缺点显而易见：</p>
<ol>
<li><p>递归由于是函数调用自身，而<strong>函数调用是有时间和空间的消耗</strong>的：每一次函数调用，都需要在内存栈中分配空间以保存参数、返回地址以及临时变量，而<strong>往栈中压入数据和弹出数据都需要时间</strong>。-&gt;效率</p>
</li>
<li><p>递归中很多计算都是重复的，由于其本质是把一个问题分解成两个或者多个小问题，<strong>多个小问题存在相互重叠的部分</strong>，则存在重复计算，如<code>fibonacci斐波那契数列</code>的递归实现。-&gt;效率</p>
</li>
</ol>
<p>因此需要考虑优化问题，若选择重构代码则太过复杂，且易产生<code>bug</code>，而使用<code>unicorn</code>就能很好地避免这个问题。</p>
<h3 id="1-利用unicorn运行目标程序"><a href="#1-利用unicorn运行目标程序" class="headerlink" title="1. 利用unicorn运行目标程序"></a>1. 利用unicorn运行目标程序</h3><p>首先先将需要的库导入：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> unicorn <span class="keyword">import</span> *				<span class="comment"># 导入unicorn库</span></span><br><span class="line"><span class="keyword">from</span> unicorn.x86_const <span class="keyword">import</span> *		<span class="comment"># 因为程序是x86架构的，故导入x86的常量</span></span><br><span class="line"><span class="keyword">import</span> struct						<span class="comment"># 用于打包数据</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">read_file</span>(<span class="params">name</span>):				<span class="comment"># 读取目标文件的数据</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(name,<span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:		<span class="comment"># 以二进制格式打开一个文件用于只读</span></span><br><span class="line">        <span class="keyword">return</span> f.read()</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">u32</span>(<span class="params">data</span>):						<span class="comment"># 解包数据</span></span><br><span class="line">    <span class="keyword">return</span> struct.unpack(<span class="string">&quot;I&quot;</span>,data)[<span class="number">0</span>]</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">p32</span>(<span class="params">num</span>):						<span class="comment"># 打包数据</span></span><br><span class="line">    <span class="keyword">return</span> struct.pack(<span class="string">&quot;I&quot;</span>,num)</span><br></pre></td></tr></table></figure>

<p>记住<code>python3</code>下二进制文件的打开形式为<strong>‘rb’</strong>，否则会报如下错误：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">UnicodeDecodeError: <span class="string">&#x27;utf-8&#x27;</span> codec can<span class="string">&#x27;t decode byte 0x90 in position 24: invalid start byte</span></span><br></pre></td></tr></table></figure>

<p>首先实例化一个基于<code>X86</code>架构的模式为<code>64位</code>的模拟器：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mu = Uc(UC_ARCH_X86, UC_MODE_64)	<span class="comment"># 其他架构和模式详见文档</span></span><br></pre></td></tr></table></figure>

<p>接着开辟两段空间，一段用于储存程序代码，另一段用于模拟栈，申请大小均为1024<em>1024(即*<em>1MB</em></em>)：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">prog_base = <span class="number">0x400000</span>		<span class="comment"># 初始空间地址</span></span><br><span class="line">prog_size = <span class="number">1024</span>*<span class="number">1024</span>		<span class="comment"># 空间大小</span></span><br><span class="line">stack_base = <span class="number">0x0</span>			<span class="comment"># 初试栈地址</span></span><br><span class="line">stack_size = <span class="number">1024</span>*<span class="number">1024</span>		<span class="comment"># 栈大小</span></span><br><span class="line"></span><br><span class="line">mu.mem_map(prog_base, prog_size)	<span class="comment"># 申请(映射) 1MB 内存用于存放程序</span></span><br><span class="line">mu.mem_map(stack_base, stack_size)	<span class="comment"># 申请(映射) 1MB 内存用于存放栈</span></span><br><span class="line"></span><br><span class="line">mu.mem_write(prog_base, read_file(<span class="string">&quot;./fibonacci&quot;</span>))	<span class="comment"># 写入程序</span></span><br><span class="line">mu.reg_write(UC_X86_REG_RSP, stack_base+stack_size-<span class="number">1</span>)	<span class="comment"># 修改RSP指针</span></span><br></pre></td></tr></table></figure>

<p>设置程序的加载地址和结束地址，分别为<code>0x4004E0</code>和<code>0x400575</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">start = <span class="number">0x4004E0</span></span><br><span class="line">end = <span class="number">0x400575</span></span><br><span class="line">mu.emu_start(start, end)	<span class="comment"># 从start开始执行直至end</span></span><br></pre></td></tr></table></figure>

<p>我们运行一下脚本，发现报错，说是读到非法的地址：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Traceback (most recent call last):</span><br><span class="line">  File <span class="string">&quot;try.py&quot;</span>, line 28, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">    mu.emu_start(start, end)</span><br><span class="line">  File <span class="string">&quot;/home/fuzz/.local/lib/python3.8/site-packages/unicorn/unicorn.py&quot;</span>, line 525, <span class="keyword">in</span> emu_start</span><br><span class="line">    raise UcError(status)</span><br><span class="line">unicorn.unicorn.UcError: Invalid memory <span class="built_in">read</span> (UC_ERR_READ_UNMAPPED)</span><br></pre></td></tr></table></figure>

<p>那么是走到哪一步报错了呢？我们需要添加<code>hook</code>将成功执行的代码和其<strong>大小</strong>给打印出来：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">hook_code</span>(<span class="params">mu, address, size, user_data</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;&gt;&gt;&gt; Tracing instruction at 0x%x, instruction size = 0x%x&#x27;</span> %(address, size))</span><br><span class="line">mu.hook_add(UC_HOOK_CODE, hook_code)	<span class="comment"># 添加了hook后每执行一句代码就会执行hook_code内的操作</span></span><br></pre></td></tr></table></figure>

<p>再次运行：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">fuzz@fuzz-virtual-machine:~/unicorn-ctf$ python3 try.py </span><br><span class="line">&gt;&gt;&gt; Tracing instruction at 0x4004e0, instruction size = 0x1</span><br><span class="line">&gt;&gt;&gt; Tracing instruction at 0x4004e1, instruction size = 0x1</span><br><span class="line">&gt;&gt;&gt; Tracing instruction at 0x4004e2, instruction size = 0x2</span><br><span class="line">&gt;&gt;&gt; Tracing instruction at 0x4004e4, instruction size = 0x5</span><br><span class="line">&gt;&gt;&gt; Tracing instruction at 0x4004e9, instruction size = 0x2</span><br><span class="line">&gt;&gt;&gt; Tracing instruction at 0x4004eb, instruction size = 0x4</span><br><span class="line">&gt;&gt;&gt; Tracing instruction at 0x4004ef, instruction size = 0x7</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File <span class="string">&quot;try.py&quot;</span>, line 34, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">    mu.emu_start(start, end)</span><br><span class="line">  File <span class="string">&quot;/home/fuzz/.local/lib/python3.8/site-packages/unicorn/unicorn.py&quot;</span>, line 525, <span class="keyword">in</span> emu_start</span><br><span class="line">    raise UcError(status)</span><br><span class="line">unicorn.unicorn.UcError: Invalid memory <span class="built_in">read</span> (UC_ERR_READ_UNMAPPED)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>可以得知，程序在执行如下<code>code</code>报错：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.text:00000000004004EF                 mov     rdi, cs:stdout  ; stream</span><br></pre></td></tr></table></figure>

<p>因为我们未在空间里引入<code>glibc</code>，所以直接跳过这些函数就好了，除此之外还需跳过的<code>code</code>有：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">.text:00000000004004F6                 call    _setbuf</span><br><span class="line">.text:0000000000400502                 call    _printf</span><br><span class="line">.text:000000000040054F                 mov     rsi, cs:stdout  ; fp</span><br></pre></td></tr></table></figure>

<p>可以通过改写<code>rip</code>进行跳过：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mu.reg_write(UC_X86_REG_RIP, address+size)</span><br></pre></td></tr></table></figure>

<p>当然我们对打印函数也应当进行处理：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">.text:0000000000400558                 movsx   edi, dil        ; c</span><br><span class="line">.text:000000000040055C                 add     rbp, 1</span><br><span class="line">.text:0000000000400560                 call    __IO_putc</span><br></pre></td></tr></table></figure>

<p><code>__IO_putc</code>将寄存器<code>rdi</code>内的元素进行输出，我们可以对其进行改写：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">c = mu.reg_read(UC_X86_REG_RDI)				<span class="comment"># 读出 rdi 里的值进行打印</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">chr</span>(c))</span><br><span class="line">mu.reg_write(UC_X86_REG_RIP, address+size)</span><br></pre></td></tr></table></figure>

<p>因此<code>hook_code</code>有：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">instructions_skip_list = [<span class="number">0x4004EF</span>,<span class="number">0x4004F6</span>,<span class="number">0x400502</span>,<span class="number">0x40054F</span>]	<span class="comment"># 跳过glibc函数</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hook_code</span>(<span class="params">mu, address, size, user_data</span>):</span><br><span class="line">    <span class="comment">#print(&#x27;&gt;&gt;&gt; Tracing instruction at 0x%x, instruction size = 0x%x&#x27; %(address, size))</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> address <span class="keyword">in</span> instructions_skip_list:</span><br><span class="line">        mu.reg_write(UC_X86_REG_RIP, address+size)</span><br><span class="line">    <span class="keyword">elif</span> address == <span class="number">0x400560</span>:	<span class="comment"># 执行到__IO_putc便打印rdi的值，并跳过</span></span><br><span class="line">        c = mu.reg_read(UC_X86_REG_RDI)</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">chr</span>(c))</span><br><span class="line">        mu.reg_write(UC_X86_REG_RIP, address+size)</span><br></pre></td></tr></table></figure>

<p>再次执行：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">fuzz@fuzz-virtual-machine:~/unicorn-ctf$ python3 try.py </span><br><span class="line">h</span><br><span class="line">x</span><br><span class="line">p</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>我们发现打印<code>flag</code>依旧很慢，因此就需要开始我们的优化工作</p>
<h3 id="2-优化程序，提高速度"><a href="#2-优化程序，提高速度" class="headerlink" title="2. 优化程序，提高速度"></a>2. 优化程序，提高速度</h3><p>很显然许多参数以及返回值一样的<code>FIB</code>函数被重复调用了多次，因此我们需要对这些被重复调用过的函数进行记录，当参数一样时，不再经过中间的计算，而直接给出返回值。</p>
<p>如何保存这些成对的值？</p>
<ul>
<li>在函数开始的时候，我们可以检查参数对应的值是否已经被dict记录<ul>
<li>如果是，直接返回这个key-value就行，只需将返回值写入到<code>RAX</code>中，同时设置<code>RIP</code>为<code>RET</code>指令的值，退出这个函数。不能在<code>fabonacci</code>函数内直接跳转到<code>RET</code>，因为这条指令已经被HOOK了，所以我们跳转到<code>main</code>中的<code>ret</code>。</li>
<li>如果dict中没有出现参数和对应的值，将参数添加到dict中。</li>
</ul>
</li>
<li>当退出函数的时候，保存返回值。可以从我们的栈结构中读取参数和返回值。</li>
</ul>
<p>因此我们需要在执行到<code>FIB</code>函数时进行判断，在<code>FIB</code>返回的时候进行更新，构造如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">Fib_entry = <span class="number">0x400670</span></span><br><span class="line">Fib_return = [<span class="number">0x4006F1</span>, <span class="number">0x400709</span>]</span><br><span class="line"></span><br><span class="line">stack = []</span><br><span class="line">d = &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hook_code</span>(<span class="params">mu, address, size, user_data</span>):</span><br><span class="line">    <span class="comment">#print(&#x27;&gt;&gt;&gt; Tracing instruction at 0x%x, instruction size = 0x%x&#x27; %(address, size))</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> address <span class="keyword">in</span> instructions_skip_list:</span><br><span class="line">        mu.reg_write(UC_X86_REG_RIP, address+size)</span><br><span class="line">    <span class="keyword">elif</span> address == <span class="number">0x400560</span>:</span><br><span class="line">        c = mu.reg_read(UC_X86_REG_RDI)</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">chr</span>(c))</span><br><span class="line">        mu.reg_write(UC_X86_REG_RIP, address+size)</span><br><span class="line">    <span class="keyword">elif</span> address == Fib_entry:</span><br><span class="line">        arg0 = mu.reg_read(UC_X86_REG_RDI)</span><br><span class="line">        r_rsi = mu.reg_read(UC_X86_REG_RSI)</span><br><span class="line">        arg1 = u32(mu.mem_read(r_rsi,<span class="number">4</span>))</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (arg0,arg1) <span class="keyword">in</span> d:</span><br><span class="line">            (ret_rax, ret_ref) = d[(arg0,arg1)]</span><br><span class="line">            mu.reg_write(UC_X86_REG_RAX, ret_rax)</span><br><span class="line">            mu.mem_write(r_rsi, p32(ret_ref))</span><br><span class="line">            mu.reg_write(UC_X86_REG_RIP,<span class="number">0x400582</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            stack.append((arg0,arg1,r_rsi))</span><br><span class="line">    <span class="keyword">elif</span> address <span class="keyword">in</span> Fib_return:</span><br><span class="line">        (arg0, arg1, r_rsi) = stack.pop()</span><br><span class="line">        ret_rax = mu.reg_read(UC_X86_REG_RAX)</span><br><span class="line">        ret_ref = u32(mu.mem_read(r_rsi,<span class="number">4</span>))</span><br><span class="line">        d[(arg0, arg1)] = (ret_rax, ret_ref)</span><br></pre></td></tr></table></figure>

<p>再次运行脚本：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">fuzz@fuzz-virtual-machine:~/unicorn-ctf$ python3 exp.py </span><br><span class="line">h</span><br><span class="line">x</span><br><span class="line">p</span><br><span class="line">&#123;</span><br><span class="line">F</span><br><span class="line">1</span><br><span class="line">b</span><br><span class="line">0</span><br><span class="line">n</span><br><span class="line">4</span><br><span class="line">c</span><br><span class="line">C</span><br><span class="line">i</span><br><span class="line">_</span><br><span class="line">n</span><br><span class="line">u</span><br><span class="line">m</span><br><span class="line">Z</span><br><span class="line">_</span><br><span class="line">4</span><br><span class="line">r</span><br><span class="line">3</span><br><span class="line">_</span><br><span class="line">T</span><br><span class="line">0</span><br><span class="line">O</span><br><span class="line">_</span><br><span class="line">3</span><br><span class="line">a</span><br><span class="line">5</span><br><span class="line">Y</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="3-完整EXP"><a href="#3-完整EXP" class="headerlink" title="3. 完整EXP"></a>3. 完整EXP</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> unicorn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> unicorn.x86_const <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">read_file</span>(<span class="params">name</span>):</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(name,<span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        <span class="keyword">return</span> f.read()</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">u32</span>(<span class="params">data</span>):</span><br><span class="line">    <span class="keyword">return</span> struct.unpack(<span class="string">&quot;I&quot;</span>,data)[<span class="number">0</span>]</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">p32</span>(<span class="params">num</span>):</span><br><span class="line">    <span class="keyword">return</span> struct.pack(<span class="string">&quot;I&quot;</span>,num)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">mu = Uc(UC_ARCH_X86, UC_MODE_64)</span><br><span class="line"></span><br><span class="line">prog_base = <span class="number">0x400000</span></span><br><span class="line">stack_base = <span class="number">0x0</span></span><br><span class="line">stack_size = <span class="number">1024</span>*<span class="number">1024</span></span><br><span class="line"></span><br><span class="line">mu.mem_map(prog_base, <span class="number">1024</span>*<span class="number">1024</span>)</span><br><span class="line">mu.mem_map(stack_base, stack_size)</span><br><span class="line"></span><br><span class="line">mu.mem_write(prog_base, read_file(<span class="string">&quot;./fibonacci&quot;</span>))</span><br><span class="line">mu.reg_write(UC_X86_REG_RSP, stack_base+stack_size-<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">start = <span class="number">0x4004E0</span></span><br><span class="line">end = <span class="number">0x400575</span></span><br><span class="line"></span><br><span class="line">instructions_skip_list = [<span class="number">0x4004EF</span>,<span class="number">0x4004F6</span>,<span class="number">0x400502</span>,<span class="number">0x40054F</span>]</span><br><span class="line"></span><br><span class="line">Fib_entry = <span class="number">0x400670</span></span><br><span class="line">Fib_return = [<span class="number">0x4006F1</span>, <span class="number">0x400709</span>]</span><br><span class="line"></span><br><span class="line">stack = []</span><br><span class="line">d = &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hook_code</span>(<span class="params">mu, address, size, user_data</span>):</span><br><span class="line">    <span class="comment">#print(&#x27;&gt;&gt;&gt; Tracing instruction at 0x%x, instruction size = 0x%x&#x27; %(address, size))</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> address <span class="keyword">in</span> instructions_skip_list:</span><br><span class="line">        mu.reg_write(UC_X86_REG_RIP, address+size)</span><br><span class="line">    <span class="keyword">elif</span> address == <span class="number">0x400560</span>:</span><br><span class="line">        c = mu.reg_read(UC_X86_REG_RDI)</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">chr</span>(c))</span><br><span class="line">        mu.reg_write(UC_X86_REG_RIP, address+size)</span><br><span class="line">    <span class="keyword">elif</span> address == Fib_entry:</span><br><span class="line">        arg0 = mu.reg_read(UC_X86_REG_RDI)</span><br><span class="line">        r_rsi = mu.reg_read(UC_X86_REG_RSI)</span><br><span class="line">        arg1 = u32(mu.mem_read(r_rsi,<span class="number">4</span>))</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (arg0,arg1) <span class="keyword">in</span> d:</span><br><span class="line">            (ret_rax, ret_ref) = d[(arg0,arg1)]</span><br><span class="line">            mu.reg_write(UC_X86_REG_RAX, ret_rax)</span><br><span class="line">            mu.mem_write(r_rsi, p32(ret_ref))</span><br><span class="line">            mu.reg_write(UC_X86_REG_RIP,<span class="number">0x400582</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            stack.append((arg0,arg1,r_rsi))</span><br><span class="line">    <span class="keyword">elif</span> address <span class="keyword">in</span> Fib_return:</span><br><span class="line">        (arg0, arg1, r_rsi) = stack.pop()</span><br><span class="line">        ret_rax = mu.reg_read(UC_X86_REG_RAX)</span><br><span class="line">        ret_ref = u32(mu.mem_read(r_rsi,<span class="number">4</span>))</span><br><span class="line">        d[(arg0, arg1)] = (ret_rax, ret_ref)</span><br><span class="line"></span><br><span class="line">mu.hook_add(UC_HOOK_CODE, hook_code)</span><br><span class="line">mu.emu_start(start, end)</span><br><span class="line"></span><br></pre></td></tr></table></figure>


    </div>

    
    
    

      <footer class="post-footer">

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2022/05/30/ciscn2022/" rel="prev" title="ciscn2022">
      <i class="fa fa-chevron-left"></i> ciscn2022
    </a></div>
      <div class="post-nav-item">
    <a href="/2022/08/14/off-by-one/" rel="next" title="off-by-one">
      off-by-one <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#hxp-CTF-2017-Fibonacci"><span class="nav-number">1.</span> <span class="nav-text">hxp CTF 2017 Fibonacci</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-%E5%88%A9%E7%94%A8unicorn%E8%BF%90%E8%A1%8C%E7%9B%AE%E6%A0%87%E7%A8%8B%E5%BA%8F"><span class="nav-number">1.1.</span> <span class="nav-text">1. 利用unicorn运行目标程序</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-%E4%BC%98%E5%8C%96%E7%A8%8B%E5%BA%8F%EF%BC%8C%E6%8F%90%E9%AB%98%E9%80%9F%E5%BA%A6"><span class="nav-number">1.2.</span> <span class="nav-text">2. 优化程序，提高速度</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-%E5%AE%8C%E6%95%B4EXP"><span class="nav-number">1.3.</span> <span class="nav-text">3. 完整EXP</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Anza"
      src="/images/Haida.png">
  <p class="site-author-name" itemprop="name">Anza</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">11</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">8</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">3</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>


  <div class="links-of-blogroll motion-element">
    <div class="links-of-blogroll-title"><i class="fa fa-link fa-fw"></i>
      Links
    </div>
    <ul class="links-of-blogroll-list">
        <li class="links-of-blogroll-item">
          <a href="https://verf1sh.github.io/" title="https:&#x2F;&#x2F;verf1sh.github.io&#x2F;" rel="noopener" target="_blank">VerF1sh</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://4xwi11.github.io/" title="https:&#x2F;&#x2F;4xwi11.github.io&#x2F;" rel="noopener" target="_blank">4XWi11</a>
        </li>
    </ul>
  </div>

      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2023</span>
  <span class="author" itemprop="copyrightHolder">Anza</span>
</div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
